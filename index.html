<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Darul Amal Academy</title>
<style>
:root{
  --blue:#0d6efd;
  --red:#dc3545;
  --yellow:#ffc107;
  --bg:#f8f9fa;
  --shadow:rgba(0,0,0,0.1);
}
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,sans-serif;}
body{background:var(--bg);display:flex;justify-content:center;}
.app{width:100%;max-width:480px;min-height:100vh;background:white;position:relative;display:flex;flex-direction:column;}

/* HEADER */
header{
  background:var(--blue);
  color:white;
  padding:16px;
  display:flex;
  gap:12px;
  align-items:center;
  box-shadow:0 3px 8px var(--shadow);
}
header img{
  width:50px;
  height:50px;
  border-radius:12px;
  object-fit:contain;
}
header h1{
  font-size:20px;
}
header small{
  font-size:12px;
  color:var(--yellow);
}

/* POSTS */
.posts{
  flex:1;
  overflow-y:auto;
  padding:12px;
}
.post-card{
  background:white;
  border-radius:16px;
  box-shadow:0 2px 8px var(--shadow);
  padding:16px;
  margin-bottom:15px;
  position:relative;
  transition:transform 0.2s;
}
.post-card:hover{transform:scale(1.01);}
.post-card h3{color:var(--blue);margin-bottom:6px;font-size:18px;}
.post-card small{color:#666;font-size:12px;}
.post-card p{margin:10px 0;color:#333;line-height:1.4;}
.post-card img{width:100%;border-radius:12px;margin-top:8px;}
.post-card a{display:block;margin-top:8px;color:var(--blue);text-decoration:none;}

/* DELETE BUTTON */
.post-card .deleteBtn{
  position:absolute;
  top:12px;right:12px;
  background:var(--red);
  color:white;
  border:none;
  border-radius:8px;
  padding:6px 10px;
  font-size:12px;
  cursor:pointer;
}

/* ADD BUTTON */
.addBtn{
  position:fixed;
  bottom:20px;
  right:20px;
  width:60px;
  height:60px;
  border-radius:50%;
  background:var(--yellow);
  border:none;
  font-size:30px;
  box-shadow:0 3px 8px var(--shadow);
  cursor:pointer;
}

/* MODALS */
.modal{
  position:fixed;
  inset:0;
  background:white;
  display:none;
  padding:20px;
  overflow-y:auto;
  z-index:100;
}
.modal.active{display:block;}
.modal h3{margin-bottom:16px;font-size:20px;color:var(--blue);}
.modal input, .modal textarea{
  width:100%;
  padding:12px;
  margin-bottom:14px;
  border-radius:10px;
  border:1px solid #ccc;
}
.modal textarea{resize:none;min-height:120px;}
.modal button{
  width:100%;
  padding:14px;
  background:var(--blue);
  color:white;
  border:none;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
}

/* TOAST */
.toast{
  position:fixed;
  top:80px;
  left:50%;
  transform:translateX(-50%);
  background:var(--blue);
  color:white;
  padding:12px 24px;
  border-radius:30px;
  opacity:0;
  transition:.3s;
  z-index:1000;
}
.toast.show{opacity:1;}
</style>
</head>
<body>
<div class="app">
<header>
  <img src="WhatsApp Image 2025-10-05 at 19.52.55.jpeg" alt="Logo">
  <div>
    <h1>Darul Amal Academy</h1>
    <small>Barcelona</small>
  </div>
</header>

<div class="posts" id="posts"></div>

<button class="addBtn" onclick="openAdd()">+</button>

<!-- LOGIN MODAL -->
<div class="modal" id="loginModal">
  <h3>Admin Login</h3>
  <input type="password" id="adminPass" placeholder="Enter admin password">
  <button onclick="login()">Login</button>
</div>

<!-- ADD POST MODAL -->
<div class="modal" id="addModal">
  <h3>Add New Post</h3>
  <input id="title" placeholder="Post title">
  <textarea id="text" placeholder="Post message"></textarea>
  <input type="file" id="file">
  <button onclick="savePost()">Publish</button>
</div>

<div class="toast" id="toast"></div>
</div>

<script>
const ADMIN_PASSWORD="Darulamal2000";
let isAdmin=localStorage.getItem("admin")==="yes";
let posts=JSON.parse(localStorage.getItem("posts")||"[]");

const postsDiv=document.getElementById("posts");
const loginModal=document.getElementById("loginModal");
const addModal=document.getElementById("addModal");
const toast=document.getElementById("toast");

function openAdd(){
  if(!isAdmin){ loginModal.classList.add("active"); }
  else{ addModal.classList.add("active"); }
}

function login(){
  if(adminPass.value===ADMIN_PASSWORD){
    isAdmin=true;
    localStorage.setItem("admin","yes");
    loginModal.classList.remove("active");
    addModal.classList.add("active");
    showToast("Admin logged in");
    render();
  }else{ alert("Wrong password"); }
}

function savePost(){
  const f=file.files[0];
  const done=(fileData)=>{
    posts.push({
      id:Date.now(),
      title:title.value,
      text:text.value,
      date:new Date().toLocaleString(),
      file:fileData
    });
    localStorage.setItem("posts",JSON.stringify(posts));
    addModal.classList.remove("active");
    title.value=text.value=file.value="";
    render();
    showToast("Post published");
  };
  if(f){
    const r=new FileReader();
    r.onload=()=>done({name:f.name,type:f.type,data:r.result});
    r.readAsDataURL(f);
  }else done(null);
}

function deletePost(id){
  if(confirm("Are you sure you want to delete this post?")){
    posts=posts.filter(p=>p.id!==id);
    localStorage.setItem("posts",JSON.stringify(posts));
    render();
    showToast("Post deleted");
  }
}

function render(){
  postsDiv.innerHTML="";
  posts.slice().reverse().forEach(p=>{
    let html=`<div class="post-card">
      <h3>${p.title}</h3>
      <small>${p.date}</small>
      <p>${p.text}</p>`;
    if(p.file){
      if(p.file.type.startsWith("image")){ html+=`<img src="${p.file.data}">`; }
      else{ html+=`<a href="${p.file.data}" download>${p.file.name}</a>`; }
    }
    if(isAdmin){
      html+=`<button class="deleteBtn" onclick="deletePost(${p.id})">Delete</button>`;
    }
    html+="</div>";
    postsDiv.innerHTML+=html;
  });
}

function showToast(msg){
  toast.textContent=msg;
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),3000);
}

/* INIT */
render();

/* INSTALL PROMPT */
window.addEventListener("beforeinstallprompt",e=>{
  e.preventDefault();
  setTimeout(()=>e.prompt(),2000);
});
</script>
</body>
</html>
